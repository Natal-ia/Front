@page
@model LoginModel
@{
    ViewData["Title"] = "Bienvenido de nuevo a JaveFamilia";
}

<div style="min-height: 100vh; display: flex; justify-content: center; align-items: center; background: #f5f5f5; padding: 20px;">
    <div style="width: 100%; max-width: 400px; background: #ffffff; border-radius: 12px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); padding: 40px;">
        <div style="text-align: center; margin-bottom: 30px;">
            <div style="width: 60px; height: 60px; background: #5c5b5b; border-radius: 50%; margin: 0 auto;"></div>
            <h1 style="color: #333; font-size: 24px; font-family: 'Poppins', sans-serif; font-weight: 600; margin-top: 20px;">Log in to your account</h1>
            <p style="color: #666; font-size: 14px; font-family: 'Poppins', sans-serif; margin-top: 8px;">
                Don't have an account? <a href="/signup" style="color: #3b3b3a; text-decoration: none;">Sign up</a>
            </p>
        </div>
        <!-- Formulario de login -->
        <form id="loginForm" onsubmit="login(event)">
            <div style="margin-bottom: 20px;">
                <label for="Email" style="color: #666; font-size: 14px; font-family: 'Poppins', sans-serif;">Email address</label>
                <input id="Email" name="Email" type="email" style="width: 100%; height: 40px; border-radius: 8px; border: 1px solid #ddd; padding: 0 10px; font-size: 14px; font-family: 'Poppins', sans-serif;" required />
            </div>
            <div style="margin-bottom: 20px;">
                <label for="Password" style="color: #666; font-size: 14px; font-family: 'Poppins', sans-serif;">Password</label>
                <input id="Password" name="Password" type="password" style="width: 100%; height: 40px; border-radius: 8px; border: 1px solid #ddd; padding: 0 10px; font-size: 14px; font-family: 'Poppins', sans-serif;" required />
            </div>
            <button type="submit" style="width: 100%; height: 45px; background: #ff5722; border: none; border-radius: 8px; color: #fff; font-size: 16px; font-family: 'Poppins', sans-serif; font-weight: 600; cursor: pointer; transition: background 0.3s;">
                Log in
            </button>
        </form>
        <div style="text-align: center; margin-top: 20px;">
            <a href="/forgot-password" style="color: #999; font-size: 14px; font-family: 'Poppins', sans-serif; text-decoration: none;">Forgot password?</a>
        </div>
    </div>
</div>

<script>
    async function login(event) {
        event.preventDefault(); // Previene que el formulario se envíe de manera tradicional

        // Obtén los valores de los campos de entrada
        const email = document.getElementById("Email").value;
        const password = document.getElementById("Password").value;

        // Crea el objeto de datos
        const data = {
            email: email,
            password: password
        };

        try {
            // Realiza la solicitud POST
            const response = await fetch("http://localhost:5050/login", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(data)
            });

            if (response.ok) {
                // Manejar la respuesta en caso de éxito
                const result = await response.json();
                alert("Login exitoso: " + JSON.stringify(result));
                // Puedes redirigir o realizar alguna acción adicional
                window.location.href = "/dashboard"; // Cambia la URL según tu página de destino
            } else {
                // Manejar errores
                alert("Error en el login: " + response.statusText);
            }
        } catch (error) {
            console.error("Error en la solicitud:", error);
            alert("Error de red o problema con el servidor.");
        }
    }
</script>
